@page "/product/{id}";
@inject HttpClient httpClient;
@using jbH60Manager.Models;



@if (product == null)
{
    <p>Loading product....</p>
}
else
{<div>
    <a class="btn-pink p-2 float-start" href="all-products">Back to List</a>
</div>
<div class="edit-form-container">
    <h1>@product.Description</h1>
    @if (product.Image != null)
    {
        <div class="text-center">
            <img src="data:image/jpeg;base64,@Convert.ToBase64String(product.Image)" height="150" width="150" alt="Image of @product.Description" />

           </div>
           


    }
    <hr />
    <dl class="row">
      
        <dt class="col-sm-10">
           Manufacturer
        </dt>
        <dd class = "col-sm-10">
            @product.Manufacturer
        </dd>
        <dt class="col-sm-10">
           Product Category
        </dt>
        <dd class="col-sm-10">
           @product.ProdCat.ProdCat
        </dd>
        <dt class="col-sm-10 @((product.Stock==0)?"text-danger":"")">
            Stock
        </dt>
        
        <dd class="col-sm-10 @((product.Stock==0)?"text-danger":"")">
            @product.Stock
        </dd>
        <dt class="col-sm-10">
           Buy Price
        </dt>
        <dd class = "col-sm-10">
            @product.BuyPrice$
        </dd>
        <dt class="col-sm-10">
            Sell Price
        </dt>
        <dd class = "col-sm-10">
            @product.SellPrice$
        </dd>
    
        <dt class="col-sm-10">
           Employee Notes
        </dt>
        <dd class="col-sm-10">
            <textarea rows="3" cols="30" disabled> @product.EmployeeNotes</textarea>
        </dd>

 
      
    </dl>
    
    
        <div>

            <a href="product/edit/updatestock/@product.ProductId" class="btn btn-sm btn-stock">Update Stock</a>
            <a href="product/edit/updateprices/@product.ProductId" class="btn btn-sm btn-price">Update Prices</a>
        </div>
</div>

    
}

@code{
  
    [Parameter]
    public string Id { get; set; }

    private Product product { get; set; }

    protected override async Task OnInitializedAsync()
    {
     
        product = await LoadProductDetails(Id);
    }

    private async Task<Product> LoadProductDetails(string id)
    {
       
        return await httpClient.GetFromJsonAsync<Product>($"http://localhost:5076/api/Products/{id}"); 
    }

}